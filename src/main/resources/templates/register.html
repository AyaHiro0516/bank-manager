<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Registration Page</title>
    <link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
    <link rel="stylesheet" href="../static/css/google.css" th:href="@{/css/google.css}">
    <link rel="stylesheet" href="../static/css/mdui.css" th:href="@{/css/mdui.css}">
    <script src="../static/js/jquery.js" th:src="@{/js/jquery.js}"></script>
    <script type="text/javascript" src="webjars/jquery/2.2.4/jquery.min.js"></script>
</head>

<body class="mdui-theme-accent-orange">

<div class="mdui-container">
    <form method="POST" action="#" th:action="@{/do_register}" class="register">
        <div class="mdui-chip">
                <span class="mdui-chip-icon mdui-color-theme-accent"><i
                        class="mdui-icon material-icons">filter_b_and_w</i></span>
            <span class="mdui-chip-title">AccountType</span>
        </div>
        <div class="select_acType">
            <select th:field="${registerBean.accountType}" class="mdui-select " mdui-select="{position: 'bottom'}">
                <option value="SavingAccount">SavingAccount</option>
                <option value="CreditAccount">CreditAccount</option>
                <option value="LoanSavingAccount">LoanSavingAccount</option>
                <option value="LoanCreditAccount">LoanCreditAccount</option>
            </select>
        </div>
        <!--<button onclick="fire_ajax_submit()" type="button"-->
        <!--class="checkName mdui-btn-dense mdui-btn mdui-btn-raised mdui-ripple  mdui-color-theme-accent">check-->
        <!--</button>-->
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">person</i>
            <label class="mdui-textfield-label">Username</label>
            <input id="userName" th:field="${registerBean.userName}"
                   class="userName_in mdui-textfield-input"></input>
        </div>
        <p class="checkResult"
           style="color: #8c9eff; margin-top: 0; margin-bottom: 0; font-size: 14px; position: relative; left: 15%;">
            waiting for check</p>
        <!--<p th:if="${#maps.containsKey(registerBean.error, 'userName') || #maps.containsKey(registerBean.error, 'isRegister')}"-->
        <!--th:text="${#maps.containsKey(registerBean.error, 'userName')} ?-->
        <!--${registerBean.error['userName']} :-->
        <!--${registerBean.error['isRegister']} " class="warning_text">this is warning</p>-->
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">vpn_key</i>
            <label class="mdui-textfield-label">Password</label>
            <input th:field="${registerBean.passWord}" class="password_in mdui-textfield-input"
                   type="password"></input>
        </div>
        <p th:if="${#maps.containsKey(registerBean.error, 'passWord')}"
           th:text="${registerBean.error['passWord']}" class="warning_text">this is warning</p>
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">spellcheck</i>
            <label class="mdui-textfield-label">Confirm Password</label>
            <input th:field="${registerBean.passWord2}" class="mdui-textfield-input" type="password"></input>
        </div>
        <p th:if="${#maps.containsKey(registerBean.error, 'passWord2')}"
           th:text="${registerBean.error['passWord2']}" class="warning_text">this is warning</p>
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">perm_identity</i>
            <label class="mdui-textfield-label">Identity Number</label>
            <input th:field="${registerBean.personId}" class="personId_in mdui-textfield-input"></input>
        </div>
        <p th:if="${#maps.containsKey(registerBean.error, 'personId')}"
           th:text="${registerBean.error['personId']}" class="warning_text">this is warning</p>
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">email</i>
            <label class="mdui-textfield-label">E-mail</label>
            <input th:field="${registerBean.email}" class="mdui-textfield-input"></input>
        </div>
        <p th:if="${#maps.containsKey(registerBean.error, 'email')}"
           th:text="${registerBean.error['email']}" class="warning_text">this is warning</p>
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">fingerprint</i>
            <label class="mdui-textfield-label">E-mail Captcha</label>
            <input class="mdui-textfield-input"></input>
            <button class="send_captcha mdui-btn mdui-btn-raised mdui-ripple mdui-color-light-green-400 mdui-btn-dense"
                    type="button"
                    style="position: absolute; left: 76.5%; top: 18px;">send
            </button>
        </div>
        <p class="checkEmailResult"
           style="color: #8c9eff; margin-top: 0; margin-bottom: 0; font-size: 14px; position: relative; left: 15%;">
            waiting for check</p>
        <div class="mdui-textfield mdui-textfield-floating-label">
            <i class="mdui-icon material-icons">edit_location</i>
            <label class="mdui-textfield-label">Address</label>
            <input th:field="${registerBean.address}" class="mdui-textfield-input"></input>
        </div>
        <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent submit"
                type="submit">submit
        </button>
        <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent reset"
                type="reset">reset
        </button>
        <a href="index.html" th:href="@{/index}" class="back_register"><i
                class="mdui-ripple mdui-icon material-icons ">arrow_back</i></a>
        <div class="warning">
            <p class="warning_text3" th:text="${message.info}"></p>
        </div>
    </form>
</div>

<script src="https://unpkg.com/popper.js@1" th:src="@{https://unpkg.com/popper.js@1}"></script>
<script src="https://unpkg.com/tippy.js@4" th:src="@{https://unpkg.com/tippy.js@4}"></script>
<script src="../static/js/mdui.js" th:src="@{/js/mdui.js}"></script>
<script src="../static/js/style.js" th:src="@{/js/style.js}"></script>
<script>
    $('#userName').bind({
        blur: fire_ajax_submit
    });

    function fire_ajax_submit() {
        var registerBean = {};
        registerBean["userName"] = $('#userName').val();
        $(".refresh").prop("disabled", true);
        $(".warning_text").hide();
        $('.warning_text3').html("");
        $.ajax({
            type: 'POST',
            contentType: "application/json",
            url: "/checkUserName",
            data: JSON.stringify(registerBean),
            dataType: 'json',
            cache: false,
            timeout: 600000,
            success: function (data) {
                var msg = JSON.stringify(data.msg).replace("\"", "").replace("\"", "");
                //alert(msg);
                if (msg === 'this name is available (oﾟ▽ﾟ)o  ') {
                    $(".checkResult").css("color", "#00c853").html(msg);
                } else {
                    $(".checkResult").css("color", "rgb(240, 66, 66)").html(msg);
                }
                $(".refresh").prop("disabled", false);
            }
        })
    }
</script>
</body>

</html>